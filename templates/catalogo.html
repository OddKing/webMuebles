{% extends 'base.html' %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/product-lightbox.css' %}">
{% endblock %}

<title>{% block title %}Muebles Barguay{% endblock %}</title>

{% block content %}
<div class="catalogo-container">
    <!-- Hero Section -->
    <div class="catalogo-hero">
        <div class="container">
            <h1 class="catalogo-title" data-i18n="catalog.hero.title">Nuestros Productos</h1>
            <p class="catalogo-subtitle" data-i18n="catalog.hero.subtitle">Diseños exclusivos para tu hogar y oficina
            </p>
        </div>
    </div>

    <!-- Search and Filter Section -->
    <div class="container mt-5 mb-4">
        <div class="row justify-content-center">
            <div class="col-md-8">
                <!-- Search Form -->
                <form action="{% url 'catalogo' %}" method="get" class="d-flex gap-2 mb-4">
                    <div class="input-group">
                        <span class="input-group-text bg-white border-end-0">
                            <i class="bi bi-search text-muted"></i>
                        </span>
                        <input type="text" name="q" class="form-control border-start-0 ps-0"
                            placeholder="Buscar productos..." value="{{ query|default:'' }}"
                            aria-label="Buscar productos">
                        <button class="btn btn-primary px-4" type="submit">Buscar</button>
                    </div>
                </form>

                <!-- Category Filters -->
                <div class="d-flex flex-wrap justify-content-center gap-2">
                    <a href="{% url 'catalogo' %}"
                        class="btn btn-outline-secondary rounded-pill {% if not categoria_actual %}active{% endif %}">
                        Todos
                    </a>
                    {% for cat in categorias %}
                    <a href="{% url 'catalogo' %}?categoria={{ cat.slug }}{% if query %}&q={{ query }}{% endif %}"
                        class="btn btn-outline-secondary rounded-pill {% if categoria_actual.id == cat.id %}active{% endif %}">
                        {{ cat.nombre }}
                    </a>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>

    <!-- Products Grid -->
    <div class="container productos-section">
        {% if productos %}
        <div class="row g-4">
            {% for producto in productos %}
            <div class="col-12 col-md-6 col-lg-4 col-xl-3">
                <div class="product-card">
                    <div class="product-image-container">
                        <img src="{{ producto.imagen.url }}" class="product-image" alt="{{ producto.nombre }}">
                    </div>
                    <div class="product-info">
                        <h3 class="product-name">{{ producto.nombre }}</h3>
                        <p class="product-description">{{ producto.descripcion }}</p>
                        <div class="product-footer">
                            <a href="{% url 'solicitar_cotizacion' producto.id %}" class="btn btn-primary btn-sm w-100">
                                <i class="bi bi-calculator"></i> <span data-i18n="catalog.btn.quote">Cotizar</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <!-- Empty State -->
        <div class="empty-catalog text-center py-5">
            <i class="bi bi-search" style="font-size: 4rem; color: #6c757d; opacity: 0.5;"></i>
            <h3 class="mt-3" data-i18n="catalog.empty.title">No se encontraron productos</h3>
            <p class="text-muted" data-i18n="catalog.empty.message">
                {% if query %}
                No hay resultados para "{{ query }}". Intenta con otros términos.
                {% elif categoria_actual %}
                No hay productos en la categoría "{{ categoria_actual.nombre }}".
                {% else %}
                Pronto agregaremos nuevos productos a nuestro catálogo.
                {% endif %}
            </p>
            <a href="{% url 'catalogo' %}" class="btn btn-outline-primary mt-3">Ver todos los productos</a>
        </div>
        {% endif %}
    </div>

    <!-- Call to Action -->
    <div class="cta-section">
        <div class="container text-center">
            <h2 class="cta-title" data-i18n="catalog.cta.title">¿Necesitas un diseño personalizado?</h2>
            <p class="cta-text" data-i18n="catalog.cta.message">Contáctanos y creamos el mueble perfecto para ti</p>
            <a href="{% url 'agendar_reunion' %}" class="btn btn-primary btn-lg px-5 rounded-pill"
                data-i18n="catalog.cta.button">Agendar Reunión</a>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/product-lightbox.js' %}"></script>
{% endblock %}